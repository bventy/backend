# Security Architecture

Security in Bventy is implemented across multiple layers to protect the integrity of the marketplace.

## Infrastructure Security

- **R2 Gating**: Media files are not public. Access is granted through time-limited signed URLs generated by the backend.
- **Database Protection**: We use parameterized queries exclusively to prevent SQL injection. Database access is restricted to the backend service.

## Access Control

- **JWT Authentication**: Secure, stateless session management.
- **Role-Based Access (RBAC)**: Middlewares ensure that users can only perform actions permitted by their role (e.g., vendors cannot accept quotes).
- **Resource Ownership**: Every request is checked against the database to ensure the requester owns or is a participant in the resource they are accessing.

## Data Gating

- **Contact Protection**: The backend enforces the "lock/unlock" state of contact information. This logic is handled at the API level, ensuring that sensitive data is never leaked to the client until the proper lifecycle stage is reached.
- **Input Validation**: All incoming API requests are validated against strict schemas to prevent malformed data from affecting system state.
